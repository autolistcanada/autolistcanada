<!DOCTYPE html>
<html lang="en" class="bg-[#F8F7F1]">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Listings Dashboard â€“ AutoList Canada</title>
  <!-- Inter Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Heroicons & Tabler for icons -->
  <script src="https://unpkg.com/feather-icons"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-image: url('listings-background.png');
      background-size: cover;
      background-attachment: fixed;
      background-repeat: no-repeat;
      min-height: 100vh;
    }
    .tone-cozy { background: #FFEDD6; color: #FF8B32; }
    .tone-budget { background: #E2F9E1; color: #1B9C48; }
    .tone-luxury { background: #F5F0FF; color: #7A46FF; }
    .tone-warm { background: #FFF8E1; color: #FFA351; }
    .tone-minimalist { background: #E9F0F5; color: #004225; }
    .sidebar-link.active { background: #FFF7F1; color: #FFA351; font-weight: 600; }
    .platform-status[data-status="listed"] { color: #1B9C48; }
    .platform-status[data-status="not_listed"] { color: #EF4444; }
    .platform-status[data-status="syncing"] { color: #FFA351; animation: spin 1.2s linear infinite; }
    .platform-status[data-status="mismatch"] { color: #FFD600; filter: drop-shadow(0 0 2px #FFD600); }
    @keyframes spin { 100% { transform: rotate(360deg); } }
    .tone-chip { font-size: 0.82rem; padding: 0.16rem 0.7rem; border-radius: 12px; font-weight: 600; }
    .bubble { opacity: 0.75; filter: blur(0.5px); transition: opacity .2s; }
    .bubble[data-tone="Cozy"] { background: #FF8B32; }
    .bubble[data-tone="Budget"] { background: #1B9C48; }
    .bubble[data-tone="Luxury"] { background: #7A46FF; }
    .bubble[data-tone="Warm"] { background: #FFA351; }
    .bubble[data-tone="Minimalist"] { background: #004225; }
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 8px; background: #f2f2f2; }
    ::-webkit-scrollbar-thumb { background: #FFA351; border-radius: 8px; }
    /* Tooltip */
    .tw-tooltip {
      position: absolute; z-index: 20; background: #222; color: #fff;
      padding: 0.25rem 0.5rem; border-radius: 0.4rem; font-size: 0.9rem; white-space: nowrap; pointer-events: none; opacity: 0; transition: opacity .1s;
    }
    [data-tooltip]:hover + .tw-tooltip, .tw-tooltip.active { opacity: 1; }
  </style>
</head>
<body class="bg-[#F8F7F1] text-[#222]">
  <!-- Sidebar -->
  <aside class="fixed top-0 left-0 h-full w-64 bg-[#FFA351] flex flex-col justify-between z-40 shadow-xl">
    <div>
      <div class="flex items-center gap-2 px-6 py-5">
        <img src="https://autolistcanada.ca/logo.png" alt="AutoList Canada" class="h-10 w-10 rounded-full shadow-md">
        <span class="text-white text-xl font-bold tracking-tight">AutoList Canada</span>
      </div>
      <nav class="mt-6 flex flex-col gap-1 px-2">
        <a href="/" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">Home</a>
        <a href="/dashboard.html" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">Dashboard</a>
        <a href="/listings.html" class="sidebar-link active px-6 py-2 rounded-lg">Listings</a>
        <a href="/ai-tools.html" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">AI Tools</a>
        <a href="/how-it-works.html" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">How It Works</a>
        <a href="/faq.html" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">FAQ</a>
        <a href="/import.html" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">Import</a>
        <a href="/terms.html" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">Terms</a>
        <a href="/privacy.html" class="sidebar-link px-6 py-2 rounded-lg hover:bg-[#FFDAB6] hover:text-[#004225]">Privacy</a>
      </nav>
      <!-- Language toggle -->
      <div class="mt-8 px-6 flex items-center gap-2">
        <button id="lang-en" class="px-3 py-1 rounded-lg font-semibold text-[#004225] bg-white border border-[#FFA351] transition hover:bg-[#FFDAB6]">EN</button>
        <span>/</span>
        <button id="lang-fr" class="px-3 py-1 rounded-lg font-semibold text-[#004225] bg-transparent border border-[#FFA351] hover:bg-[#FFDAB6]">FR</button>
      </div>
    </div>
    <div class="px-6 pb-7 flex flex-col gap-2">
      <span class="text-xs text-white/80">Canadian-Owned â€¢ AI-Powered â€¢ Privacy-First</span>
      <div class="flex gap-2">
        <img src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/flag.svg" alt="Canadian-Owned" class="h-6 w-6 bg-white rounded-full p-1">
        <img src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/brain.svg" alt="AI-Powered" class="h-6 w-6 bg-white rounded-full p-1">
        <img src="https://cdn.jsdelivr.net/gh/tabler/tabler-icons/icons/shield-lock.svg" alt="Privacy-First" class="h-6 w-6 bg-white rounded-full p-1">
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="ml-64 min-h-screen px-6 py-8 flex flex-col gap-8 transition-all">
    <!-- Header Filters & Search -->
    <section class="flex flex-col md:flex-row md:items-end gap-4 md:gap-8">
      <!-- Filter tabs -->
      <div class="flex gap-2">
        <button class="listing-tab-tab px-4 py-2 rounded-full bg-white text-[#004225] shadow hover:bg-[#FFA351]/10 font-semibold border-2 border-[#FFA351]" data-status="all">All</button>
        <button class="listing-tab-tab px-4 py-2 rounded-full bg-white text-[#004225]/80 hover:bg-[#FFA351]/10 font-semibold border border-[#FFA351]" data-status="active">Active</button>
        <button class="listing-tab-tab px-4 py-2 rounded-full bg-white text-[#004225]/80 hover:bg-[#FFA351]/10 font-semibold border border-[#FFA351]" data-status="draft">Draft</button>
        <button class="listing-tab-tab px-4 py-2 rounded-full bg-white text-[#004225]/80 hover:bg-[#FFA351]/10 font-semibold border border-[#FFA351]" data-status="unlisted">Unlisted</button>
        <button class="listing-tab-tab px-4 py-2 rounded-full bg-white text-[#004225]/80 hover:bg-[#FFA351]/10 font-semibold border border-[#FFA351]" data-status="sold">Sold</button>
        <button class="listing-tab-tab px-4 py-2 rounded-full bg-white text-[#004225]/80 hover:bg-[#FFA351]/10 font-semibold border border-[#FFA351]" data-status="error">Error</button>
      </div>
      <!-- Advanced Filters -->
      <div class="flex flex-wrap gap-2 ml-0 md:ml-6">
        <select class="rounded-lg border border-[#FFA351] text-[#004225] px-3 py-2 bg-white">
          <option value="">Filter by Tone</option>
          <option>Cozy</option>
          <option>Budget</option>
          <option>Luxury</option>
          <option>Warm</option>
          <option>Minimalist</option>
        </select>
        <select class="rounded-lg border border-[#FFA351] text-[#004225] px-3 py-2 bg-white">
          <option value="">Filter by Platform</option>
          <option>eBay</option>
          <option>Etsy</option>
          <option>Poshmark</option>
          <option>Shopify</option>
          <option>Depop</option>
          <option>Mercari</option>
          <option>Facebook</option>
          <option>Instagram</option>
          <option>TikTok</option>
        </select>
      </div>
      <!-- Search bar -->
      <div class="flex items-center w-full md:w-64 ml-auto">
        <input type="text" id="listing-search" placeholder="Search by title, SKU, or platform..." class="w-full px-4 py-2 rounded-lg border border-[#FFA351] focus:ring-2 focus:ring-[#FFA351]/50 bg-white text-[#004225] placeholder:text-[#004225]/60">
        <i data-feather="search" class="ml-[-2rem] text-[#FFA351]"></i>
      </div>
    </section>
    <!-- Bulk Actions -->
    <section class="flex items-center gap-3">
      <button class="bulk-action-btn flex items-center gap-2 px-4 py-2 rounded-lg bg-[#004225] text-white font-semibold shadow hover:bg-[#FFA351] hover:text-[#004225] transition"><i class="ti ti-square-check"></i> Bulk Delist</button>
      <button class="bulk-action-btn flex items-center gap-2 px-4 py-2 rounded-lg bg-[#FFA351] text-[#004225] font-semibold shadow hover:bg-[#004225] hover:text-white transition"><i class="ti ti-arrows-exchange"></i> Bulk Relist</button>
      <button class="bulk-action-btn flex items-center gap-2 px-4 py-2 rounded-lg bg-white text-[#004225] font-semibold border border-[#FFA351] shadow hover:bg-[#FFA351]/10 transition"><i class="ti ti-share"></i> Crosslist to...</button>
    </section>
    
    <!-- Listings Table -->
    <section class="overflow-x-auto w-full">
      <table class="min-w-[900px] w-full bg-white rounded-2xl shadow-lg overflow-hidden">
        <thead>
          <tr class="bg-[#FFF7F1] text-[#004225] text-[1rem] font-semibold">
            <th class="p-4"><input type="checkbox" id="select-all"></th>
            <th class="p-4">Image</th>
            <th class="p-4 text-left">Title</th>
            <th class="p-4">AI</th>
            <th class="p-4">Edit</th>
            <th class="p-4">Copy</th>
            <th class="p-4">Delete</th>
            <th class="p-4">SKU</th>
            <th class="p-4">Price</th>
            <th class="p-4">Tone</th>
            <th class="p-4">Platforms</th>
          </tr>
        </thead>
        <tbody id="listing-table-body" class="text-[#222]">
          <!-- Listings will be injected here by JS (see below for sample data + rendering logic) -->
        </tbody>
      </table>
    </section>

    <!-- Buyer Psychology Map Footer -->
    <section class="flex flex-col md:flex-row md:items-end gap-6 mt-8">
      <div class="flex-1">
        <h2 class="text-lg font-semibold text-[#004225]">Buyer Psychology Map <span class="text-[#FFA351]">(Canada)</span></h2>
        <div class="relative w-full bg-white rounded-xl shadow-lg mt-2 py-6 px-3 overflow-x-auto" style="min-height:220px;">
          <!-- SVG Canada Map and Bubbles -->
          <svg viewBox="0 0 800 220" class="w-full h-52" fill="none">
            <!-- Sample province bubbles: BC, AB, ON, QC, Atlantic -->
            <circle class="bubble" data-tone="Cozy" cx="90" cy="120" r="38" />
            <circle class="bubble" data-tone="Luxury" cx="230" cy="110" r="27" />
            <circle class="bubble" data-tone="Budget" cx="410" cy="130" r="42" />
            <circle class="bubble" data-tone="Warm" cx="590" cy="120" r="31" />
            <circle class="bubble" data-tone="Minimalist" cx="710" cy="138" r="18" />
            <!-- Labels -->
            <text x="70" y="165" fill="#222" font-size="14">BC</text>
            <text x="210" y="155" fill="#222" font-size="14">AB</text>
            <text x="390" y="175" fill="#222" font-size="14">ON</text>
            <text x="570" y="165" fill="#222" font-size="14">QC</text>
            <text x="690" y="190" fill="#222" font-size="14">ATL</text>
          </svg>
          <!-- Legend -->
          <div class="flex gap-5 items-center mt-2 px-2">
            <span class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full tone-cozy"></span> Cozy</span>
            <span class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full tone-budget"></span> Budget</span>
            <span class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full tone-luxury"></span> Luxury</span>
            <span class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full tone-warm"></span> Warm</span>
            <span class="flex items-center gap-1"><span class="inline-block w-3 h-3 rounded-full tone-minimalist"></span> Minimalist</span>
          </div>
        </div>
      </div>
      <!-- Legal text and badges -->
      <div class="flex flex-col gap-2 items-end md:ml-8">
        <div class="flex gap-3">
          <span class="flex items-center gap-1 text-xs text-[#004225] bg-[#FFA351]/20 rounded px-2 py-1"><i class="ti ti-flag"></i>Canadian-Owned</span>
          <span class="flex items-center gap-1 text-xs text-[#004225] bg-[#FFA351]/20 rounded px-2 py-1"><i class="ti ti-brain"></i>AI-Powered</span>
          <span class="flex items-center gap-1 text-xs text-[#004225] bg-[#FFA351]/20 rounded px-2 py-1"><i class="ti ti-shield-lock"></i>Privacy-First</span>
        </div>
        <span class="text-xs text-[#888]">Â© 2025 AutoList Canada. All rights reserved. | Made with science, psychology, and care ðŸ‡¨ðŸ‡¦</span>
      </div>
    </section>
  </main>

  <!-- AI Action Modal -->
  <div id="ai-modal" class="fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-xl shadow-2xl p-7 w-full max-w-lg relative">
      <button onclick="closeAIModal()" class="absolute top-3 right-3 text-[#FFA351] hover:text-[#004225]"><i data-feather="x"></i></button>
      <h3 class="text-lg font-semibold text-[#004225] mb-2">AI Actions for <span id="ai-modal-title"></span></h3>
      <div class="flex flex-col gap-4">
        <div>
          <div class="flex items-center gap-2 mb-1"><i class="ti ti-sparkles text-[#FFA351]"></i> <span class="font-semibold text-[#004225]">Auto Title Suggestion</span></div>
          <input type="text" id="ai-title-suggest" class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225] font-semibold">
          <button class="mt-2 px-3 py-1 rounded-lg bg-[#FFA351] text-[#004225] font-semibold hover:bg-[#004225] hover:text-white transition" onclick="applyAISuggestion('title')">Apply</button>
        </div>
        <div>
          <div class="flex items-center gap-2 mb-1"><i class="ti ti-message-dots text-[#FFA351]"></i> <span class="font-semibold text-[#004225]">Description Enhancer</span></div>
          <textarea id="ai-desc-suggest" class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225]" rows="2"></textarea>
          <button class="mt-2 px-3 py-1 rounded-lg bg-[#FFA351] text-[#004225] font-semibold hover:bg-[#004225] hover:text-white transition" onclick="applyAISuggestion('desc')">Apply</button>
        </div>
        <div>
          <div class="flex items-center gap-2 mb-1"><i class="ti ti-currency-dollar text-[#FFA351]"></i> <span class="font-semibold text-[#004225]">Pricing Optimizer</span></div>
          <input type="number" id="ai-price-suggest" class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225] font-semibold">
          <button class="mt-2 px-3 py-1 rounded-lg bg-[#FFA351] text-[#004225] font-semibold hover:bg-[#004225] hover:text-white transition" onclick="applyAISuggestion('price')">Apply</button>
        </div>
        <div>
          <div class="flex items-center gap-2 mb-1"><i class="ti ti-color-swatch text-[#FFA351]"></i> <span class="font-semibold text-[#004225]">Tone Converter</span></div>
          <select id="ai-tone-suggest" class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225] font-semibold">
            <option>Cozy</option>
            <option>Budget</option>
            <option>Luxury</option>
            <option>Warm</option>
            <option>Minimalist</option>
          </select>
          <button class="mt-2 px-3 py-1 rounded-lg bg-[#FFA351] text-[#004225] font-semibold hover:bg-[#004225] hover:text-white transition" onclick="applyAISuggestion('tone')">Apply</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Modal Placeholder -->
  <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center hidden">
    <div class="bg-white rounded-xl shadow-2xl p-7 w-full max-w-lg relative">
      <button onclick="closeEditModal()" class="absolute top-3 right-3 text-[#FFA351] hover:text-[#004225]"><i data-feather="x"></i></button>
      <h3 class="text-lg font-semibold text-[#004225] mb-2">Edit Listing</h3>
      <form id="edit-listing-form" class="flex flex-col gap-3">
        <!-- Form fields will be injected here -->
      </form>
      <div class="flex justify-end gap-2 mt-4">
        <button type="button" onclick="closeEditModal()" class="px-4 py-2 rounded-lg bg-[#F8F7F1] text-[#004225] border border-[#FFA351] font-semibold hover:bg-[#FFA351]/30">Cancel</button>
        <button type="submit" form="edit-listing-form" class="px-4 py-2 rounded-lg bg-[#FFA351] text-[#004225] font-semibold hover:bg-[#004225] hover:text-white transition">Save</button>
      </div>
    </div>
  </div>

  <!-- Tooltips root -->
  <div id="tooltip-root"></div>

  <script>
    // Platform icons and statuses logic
    const platforms = [
      { name: 'eBay', icon: '<i class="ti ti-brand-ebay"></i>' },
      { name: 'Etsy', icon: '<i class="ti ti-brand-etsy"></i>' },
      { name: 'Poshmark', icon: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" fill="#A0142F"/><text x="11.5" y="17" text-anchor="middle" fill="#fff" font-size="12" font-family="Inter" font-weight="bold">P</text></svg>' },
      { name: 'Shopify', icon: '<i class="ti ti-brand-shopify"></i>' },
      { name: 'Depop', icon: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none"><rect x="2" y="2" width="20" height="20" rx="5" fill="#FF4343"/><text x="12" y="17" text-anchor="middle" fill="#fff" font-size="12" font-family="Inter" font-weight="bold">D</text></svg>' },
      { name: 'Mercari', icon: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none"><rect x="2" y="2" width="20" height="20" rx="5" fill="#00B7FF"/><text x="12" y="17" text-anchor="middle" fill="#fff" font-size="12" font-family="Inter" font-weight="bold">M</text></svg>' },
      { name: 'Facebook', icon: '<i class="ti ti-brand-facebook"></i>' },
      { name: 'Instagram', icon: '<i class="ti ti-brand-instagram"></i>' },
      { name: 'TikTok', icon: '<i class="ti ti-brand-tiktok"></i>' }
    ];

    // Example listing data (replace with real AJAX/fetch logic in production)
    const listings = [
      {
        id: 1,
        image: 'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=thumb&w=80&q=80',
        title: 'Vintage Denim Jacket â€“ Relaxed Fit',
        description: 'A classic, soft-wash denim jacket for all seasons. Trusted seller, quick shipping!',
        sku: 'JK-1001',
        price: 52.00,
        tones: ['Cozy', 'Minimalist'],
        status: 'active',
        platforms: {
          eBay: { status: 'listed', tooltip: 'eBay â€“ Synced 2h ago' },
          Etsy: { status: 'not_listed', tooltip: 'Etsy â€“ Not yet published' },
          Poshmark: { status: 'listed', tooltip: 'Poshmark â€“ Synced 5m ago' },
          Shopify: { status: 'syncing', tooltip: 'Shopify â€“ Syncing...' },
          Depop: { status: 'not_listed', tooltip: 'Depop â€“ Not yet published' },
          Mercari: { status: 'mismatch', tooltip: 'Mercari â€“ Price mismatch' },
          Facebook: { status: 'listed', tooltip: 'Facebook â€“ Synced 1d ago' },
          Instagram: { status: 'listed', tooltip: 'Instagram â€“ Synced 1d ago' },
          TikTok: { status: 'not_listed', tooltip: 'TikTok â€“ Not yet published' }
        }
      },
      {
        id: 2,
        image: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=thumb&w=80&q=80',
        title: 'Artisan Ceramic Mug â€“ Warm Sand',
        description: 'Hand-thrown, dishwasher-safe, and made in Canada. Build trust with every sip.',
        sku: 'MG-2022',
        price: 34.99,
        tones: ['Warm', 'Luxury'],
        status: 'draft',
        platforms: {
          eBay: { status: 'not_listed', tooltip: 'eBay â€“ Not yet published' },
          Etsy: { status: 'listed', tooltip: 'Etsy â€“ Synced 14m ago' },
          Poshmark: { status: 'not_listed', tooltip: 'Poshmark â€“ Not yet published' },
          Shopify: { status: 'listed', tooltip: 'Shopify â€“ Synced 3h ago' },
          Depop: { status: 'listed', tooltip: 'Depop â€“ Synced 20m ago' },
          Mercari: { status: 'listed', tooltip: 'Mercari â€“ Synced 6d ago' },
          Facebook: { status: 'not_listed', tooltip: 'Facebook â€“ Not yet published' },
          Instagram: { status: 'not_listed', tooltip: 'Instagram â€“ Not yet published' },
          TikTok: { status: 'not_listed', tooltip: 'TikTok â€“ Not yet published' }
        }
      },
      {
        id: 3,
        image: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=thumb&w=80&q=80',
        title: 'Minimalist Desk Lamp â€“ Forest Green',
        description: 'Brighten your workspace with calming, energy-efficient light. Ships today.',
        sku: 'LP-4019',
        price: 68.50,
        tones: ['Minimalist'],
        status: 'active',
        platforms: {
          eBay: { status: 'listed', tooltip: 'eBay â€“ Synced 1h ago' },
          Etsy: { status: 'syncing', tooltip: 'Etsy â€“ Syncing...' },
          Poshmark: { status: 'listed', tooltip: 'Poshmark â€“ Synced 10m ago' },
          Shopify: { status: 'mismatch', tooltip: 'Shopify â€“ Price mismatch' },
          Depop: { status: 'listed', tooltip: 'Depop â€“ Synced 2d ago' },
          Mercari: { status: 'not_listed', tooltip: 'Mercari â€“ Not yet published' },
          Facebook: { status: 'listed', tooltip: 'Facebook â€“ Synced 4h ago' },
          Instagram: { status: 'listed', tooltip: 'Instagram â€“ Synced 5h ago' },
          TikTok: { status: 'listed', tooltip: 'TikTok â€“ Synced 3h ago' }
        }
      }
    ];

    // Tone tag color classes
    const toneColorMap = {
      Cozy: 'tone-cozy',
      Budget: 'tone-budget',
      Luxury: 'tone-luxury',
      Warm: 'tone-warm',
      Minimalist: 'tone-minimalist'
    };

    // Render listings table
    function renderListings() {
      const tbody = document.getElementById('listing-table-body');
      tbody.innerHTML = '';
      listings.forEach((l, idx) => {
        const tr = document.createElement('tr');
        tr.className = 'border-b last:border-0 hover:bg-[#FFF7F1]/60 transition group';
        tr.innerHTML = `
          <td class="text-center p-4"><input type="checkbox" class="listing-checkbox"></td>
          <td class="p-4"><img src="${l.image}" alt="${l.title}" class="h-16 w-16 rounded-lg object-cover shadow"></td>
          <td class="p-4 text-left font-semibold text-[#004225] cursor-pointer hover:underline" onclick="openEditModal(${l.id})">${l.title}</td>
          <td class="p-4 text-center">
            <button title="AI Suggest" onclick="openAIModal(${l.id})" class="inline-flex items-center px-2 py-1 rounded-lg bg-[#FFA351]/20 hover:bg-[#FFA351] hover:text-white text-[#004225] font-bold transition"><i class="ti ti-sparkles"></i> âš¡</button>
          </td>
          <td class="p-4 text-center">
            <button title="Edit" onclick="openEditModal(${l.id})" class="inline-flex items-center px-2 py-1 rounded-lg bg-[#F8F7F1] hover:bg-[#FFA351]/40 text-[#004225]"><i class="ti ti-edit"></i></button>
          </td>
          <td class="p-4 text-center">
            <button title="Copy Listing" onclick="duplicateListing(${l.id})" class="inline-flex items-center px-2 py-1 rounded-lg bg-[#F8F7F1] hover:bg-[#FFA351]/40 text-[#004225]"><i class="ti ti-copy"></i></button>
          </td>
          <td class="p-4 text-center">
            <button title="Delete" onclick="deleteListing(${l.id})" class="inline-flex items-center px-2 py-1 rounded-lg bg-[#F8F7F1] hover:bg-red-100 text-[#EF4444]"><i class="ti ti-trash"></i></button>
          </td>
          <td class="p-4 text-center font-mono">${l.sku}</td>
          <td class="p-4 text-center font-semibold text-[#004225]">$${l.price.toFixed(2)} <span class="text-xs text-[#888]">CAD</span></td>
          <td class="p-4 text-center">
            ${l.tones.map(tone => `<span class="tone-chip ${toneColorMap[tone]} mr-1">${tone}</span>`).join('')}
          </td>
          <td class="p-4 text-center">
            <div class="flex flex-wrap gap-1 justify-center">
              ${platforms.map(p => {
                // Map platform key from display name
                let key = p.name.replace(/[^A-Za-z]/g, '');
                let pl = l.platforms[key] || l.platforms[p.name] || {status: 'not_listed', tooltip: `${p.name} â€“ Not yet published`};
                let status = pl.status;
                let iconHtml = p.icon.replace('20', '18'); // ensure uniform sizing
                return `<span class="relative group">
                  <span class="platform-status inline-flex items-center text-xl align-middle" data-status="${status}" data-tooltip="${pl.tooltip}" aria-label="${p.name}">
                    ${iconHtml}
                  </span>
                  <span class="tw-tooltip absolute left-1/2 -translate-x-1/2 bottom-7 z-30 bg-[#222] text-white px-2 py-1 rounded opacity-0 pointer-events-none text-xs transition whitespace-nowrap">${pl.tooltip}</span>
                </span>`;
              }).join('')}
            </div>
          </td>
        `;
        tbody.appendChild(tr);
      });
      // Tooltips
      document.querySelectorAll('.platform-status').forEach(el => {
        el.addEventListener('mouseenter', function() {
          let tooltip = this.parentElement.querySelector('.tw-tooltip');
          tooltip.classList.add('active');
        });
        el.addEventListener('mouseleave', function() {
          let tooltip = this.parentElement.querySelector('.tw-tooltip');
          tooltip.classList.remove('active');
        });
      });
    }

    // AI Modal Logic
    function openAIModal(listingId) {
      const listing = listings.find(l => l.id === listingId);
      document.getElementById('ai-modal-title').textContent = listing.title;
      document.getElementById('ai-title-suggest').value = listing.title + " (AI suggested)";
      document.getElementById('ai-desc-suggest').value = listing.description + " (Trust-building copy)";
      document.getElementById('ai-price-suggest').value = (listing.price * 1.07).toFixed(2);
      document.getElementById('ai-tone-suggest').value = listing.tones[0] || 'Cozy';
      document.getElementById('ai-modal').classList.remove('hidden');
    }
    function closeAIModal() {
      document.getElementById('ai-modal').classList.add('hidden');
    }
    function applyAISuggestion(type) {
      // For demo: just alert, in prod replace/update table row
      alert('Applied AI suggestion for ' + type + '!');
      closeAIModal();
    }

    // Edit Modal Logic
    function openEditModal(listingId) {
      const listing = listings.find(l => l.id === listingId);
      const form = document.getElementById('edit-listing-form');
      form.innerHTML = `
        <label class="font-semibold text-[#004225]">Title
          <input type="text" class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225]" value="${listing.title}">
        </label>
        <label class="font-semibold text-[#004225]">Description
          <textarea class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225]" rows="2">${listing.description}</textarea>
        </label>
        <label class="font-semibold text-[#004225]">SKU
          <input type="text" class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225]" value="${listing.sku}">
        </label>
        <label class="font-semibold text-[#004225]">Price (CAD)
          <input type="number" class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225]" value="${listing.price}">
        </label>
        <label class="font-semibold text-[#004225]">Tones
          <select multiple class="w-full px-3 py-2 rounded-lg border border-[#FFA351] bg-[#F8F7F1] text-[#004225]">
            <option${listing.tones.includes('Cozy') ? ' selected' : ''}>Cozy</option>
            <option${listing.tones.includes('Budget') ? ' selected' : ''}>Budget</option>
            <option${listing.tones.includes('Luxury') ? ' selected' : ''}>Luxury</option>
            <option${listing.tones.includes('Warm') ? ' selected' : ''}>Warm</option>
            <option${listing.tones.includes('Minimalist') ? ' selected' : ''}>Minimalist</option>
          </select>
        </label>
      `;
      document.getElementById('edit-modal').classList.remove('hidden');
    }
    function closeEditModal() {
      document.getElementById('edit-modal').classList.add('hidden');
    }

    // Copy/Duplicate
    function duplicateListing(listingId) {
      alert('Listing duplicated! (Demo)');
    }
    // Delete
    function deleteListing(listingId) {
      if (confirm('Are you sure you want to delete this listing?')) {
        alert('Listing deleted! (Demo)');
      }
    }

    // Select all/bulk
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('select-all').addEventListener('change', function() {
        document.querySelectorAll('.listing-checkbox').forEach(cb => cb.checked = this.checked);
      });
      feather.replace();
      renderListings();
    });

    // Language toggle logic (hardcoded demo)
    document.getElementById('lang-en').addEventListener('click', () => {
      alert('English mode (Demo)');
    });
    document.getElementById('lang-fr').addEventListener('click', () => {
      alert('French mode coming soon! (Demo)');
    });

    // Search/filter logic (demo: only filter by title)
    document.getElementById('listing-search').addEventListener('input', function() {
      const query = this.value.toLowerCase();
      const tbody = document.getElementById('listing-table-body');
      Array.from(tbody.children).forEach(tr => {
        const titleCell = tr.querySelector('td:nth-child(3)');
        if (!titleCell) return;
        const visible = titleCell.textContent.toLowerCase().includes(query);
        tr.style.display = visible ? '' : 'none';
      });
    });

    // Listing tab filter (demo: only status)
    document.querySelectorAll('.listing-tab-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        document.querySelectorAll('.listing-tab-tab').forEach(t => t.classList.remove('border-2','font-semibold','bg-white'));
        this.classList.add('border-2','font-semibold','bg-white');
        const status = this.getAttribute('data-status');
        const tbody = document.getElementById('listing-table-body');
        Array.from(tbody.children).forEach((tr, idx) => {
          const listing = listings[idx];
          if (status === 'all' || listing.status === status) {
            tr.style.display = '';
          } else {
            tr.style.display = 'none';
          }
        });
      });
    });
  </script>
</body>
</html>
